geom_col() +
coord_flip() +
facet_wrap(~ sentiment, scales = "free")
charles_dickens_collection <- gutenberg_download(c(1400, 98, 1023, 24022, 766, 730),
meta_fields = "title")
charles_dickens_collection %>% count(title)
tidy_dickens <- charles_dickens_collection %>%
group_by(title) %>%
mutate(linenumber = row_number(),
chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]", ignore_case = TRUE)))) %>%
ungroup() %>%
unnest_tokens(word, text)
charles_dickens_sentiment <- tidy_dickens %>%
inner_join(get_sentiments("bing")) %>%
count(title, index = linenumber %/% 80, sentiment) %>%
spread(sentiment, n, fill = 0) %>%
mutate(sentiment = positive - negative)
ggplot(charles_dickens_sentiment, aes(index, sentiment, fill = title)) +
geom_col(show.legend = FALSE) +
facet_wrap(~title, ncol = 2, scales = "free_x")
two_cities <- tidy_dickens %>%
filter(title == "A Tale of Two Cities")
two_cities
afinn <- two_cities %>%
inner_join(get_sentiments("afinn")) %>%
group_by(index = linenumber %/% 80) %>%
summarise(sentiment = sum(score)) %>%
mutate(method = "AFINN")
bing_and_nrc <- bind_rows(two_cities %>%
inner_join(get_sentiments("bing")) %>%
mutate(method = "Bing et al."), two_cities %>%
inner_join(get_sentiments("nrc") %>%
filter(sentiment %in% c("positive", "negative"))) %>%
mutate(method = "NRC")) %>%
count(method, index = linenumber %/% 80, sentiment) %>%
spread(sentiment, n, fill = 0) %>%
mutate(sentiment = positive - negative)
bind_rows(afinn, bing_and_nrc) %>%
ggplot(aes(index, sentiment, fill = method)) +
geom_col(show.legend = FALSE) +
facet_wrap(~method, ncol = 1, scales = "free_y")
tidy_dickens
unique(tidy_dickens$title)
book_words <- tidy_dickens %>%
count(title, word, sort = TRUE)
book_words
book_tfidf <- book_words %>%
bind_tf_idf(word, title, n) %>%
arrange(-tf_idf)
book_tfidf
book_tfidf %>%
group_by(title) %>%
top_n(10) %>%
ungroup %>%
ggplot(aes(fct_reorder(word, tf_idf),
tf_idf,
fill = title)) +
geom_col(show.legend = FALSE) +
coord_flip() +
facet_wrap(~title, scales = "free")
austen_bigrams <- austen_books() %>%
unnest_tokens(bigram, text, token = "ngrams", n = 2)
austen_bigrams
austen_bigrams %>%
count(bigram, sort = TRUE)
bigrams_separated <- austen_bigrams %>%
separate(bigram, c("word1", "word2"), sep = " ")
bigrams_filtered <- bigrams_separated %>%
filter(!word1 %in% stop_words$word) %>%
filter(!word2 %in% stop_words$word)
bigram_counts <- bigrams_filtered %>%
count(word1, word2, sort = TRUE)
bigram_counts
bigrams_filtered %>%
filter(word2 == "street") %>%
count(book, word1, sort = TRUE)
austen_bigrams %>%
count(bigram, sort = TRUE)
austen_separated <- austen_bigrams %>%
separate(bigram, c("word1", "word2"), sep = " ")
austen_she <- austen_separated %>%
filter(word1 == "she") %>%
count(book, word2) %>%
rename(word = word2, she_n = n) %>%
select(-book) %>%
group_by(word) %>%
summarize(she_n = sum(she_n)) %>%
filter(she_n > 1) %>%
arrange(desc(she_n))
view(austen_she)
austen_he <- austen_separated %>%
filter(word1 == "he") %>%
count(book, word2) %>%
rename(word = word2, he_n = n) %>%
select(-book) %>%
group_by(word) %>%
summarize(he_n = sum(he_n)) %>%
filter(he_n > 1) %>%
arrange(desc(he_n))
view(austen_he)
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio = she_n / he_n) %>%
arrange(desc(verb_ratio))
gender_combine
gender_perception <- rbind(head(gender_combine, 15), tail(gender_combine, 15))
view(gender_perception)
view(gender_perception)
cut_off = 1
tidy_gender <- gender_combine %>%
filter(verb_ratio >= 3.5 | verb_ratio <= 0.6) %>%
mutate(verb_ratio = verb_ratio - 1) %>%
mutate(sign = )
ggplot(aes(fct_reorder(word, verb_ratio), verb_ratio)) +
geom_col(show.legend =FALSE) +
coord_flip()
book_tfidf %>%
group_by(title) %>%
top_n(10) %>%
ungroup %>%
ggplot(aes(fct_reorder(word, tf_idf),
tf_idf,
fill = title)) +
geom_col(show.legend = FALSE) +
coord_flip() +
facet_wrap(~title, scales = "free")
cut_off = 1
tidy_gender <- gender_combine %>%
filter(verb_ratio >= 3.5 | verb_ratio <= 0.6) %>%
mutate(verb_ratio = verb_ratio - 1)
ggplot(aes(fct_reorder(word, verb_ratio), verb_ratio)) +
geom_col(show.legend =FALSE) +
coord_flip()
tidy_gender
ggplot(aes(word, verb_ratio)) +
geom_col(show.legend =FALSE) +
coord_flip()
tidy_gender %>%
ggplot(aes(fct_reorder(word, verb_ratio), verb_ratio)) +
geom_col(show.legend =FALSE) +
coord_flip()
view(austen_she)
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio = she_n / he_n) %>%
arrange(desc(verb_ratio))
gender_combine
gender_combine <- inner_join(austen_she, austen_he) %>%
#  anti_join(stop_words)  %>%
mutate(verb_ratio = she_n / he_n) %>%
arrange(desc(verb_ratio))
gender_combine
view(gender_combine)
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio = she_n / he_n) %>%
arrange(desc(verb_ratio))
view(gender_combine)
gender_combine <- inner_join(austen_she, austen_he) %>%
#  anti_join(stop_words)  %>%
mutate(verb_ratio = she_n / he_n) %>%
arrange(desc(verb_ratio))
view(gender_combine)
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = he_n / she_n) %>%
arrange(desc(verb_ratio))
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = he_n / she_n)
view(gender_combine)
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n))
view(gender_combine)
?if
?if()
?if()
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n)) %>%
if (verb_ratio_she > 1) {
verb_ratio_she = 0
} else {
verb_ratio_she
}
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n))
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n)) %>%
if (verb_ratio_she < 1) {
verb_ratio_she == 0
}
view(gender_combine)
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n)) %>%
for(i in seq_along()) {
if (verb_ratio_she < 1) {
verb_ratio_she <- 0
}} %>%
arrange(desc(verb_ratio_she))
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n)) %>%
for(i in seq_along()) {
if (verb_ratio_she[[i]] < 1) {
verb_ratio_she[[i]] <- 0
}} %>%
arrange(desc(verb_ratio_she))
df <- tibble(
a = rnorm(10),
b = rnorm(10),
c = rnorm(10),
d = rnorm(10)
)
df
median(df$a)
median(df$b)
median(df$c)
median(df$d)
output <- vector("double", ncol(df))
for (i in seqalong(df)) {
output[[i]] <- median(df[[i]])
}
output
output <- vector("double", ncol(df))
for (i in seq_along(df)) {
output[[i]] <- median(df[[i]])
}
output
?seq_along
for(i in seq_along(gender_combine)) {
if (verb_ratio_she[[i]] < 1) {
verb_ratio_she[[i]] <- 0
}} %>%
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n)) %>%
arrange(desc(verb_ratio_she))
view(gender_combine)
for(i in seq_along(gender_combine)) {
if (verb_ratio_she[[i]] < 1) {
verb_ratio_she[[i]] <- 0
}}
for(i in seq_along(gender_combine$verb_ratio_she)) {
if (verb_ratio_she[[i]] < 1) {
verb_ratio_she[[i]] <- 0
}}
df
median(df$a)
median(df$b)
median(df$c)
median(df$d)
output <- vector("double", ncol(df))
for (i in seq_along(df)) {
output[[i]] <- median(df[[i]])
}
output
?mutate_if
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n)) %>%
mutate(verb_ratio_she = replace(verb_ratio_she, verb_ratio_she < 1, 0)) %>%
arrange(desc(verb_ratio_she))
view(gender_combine)
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n)) %>%
mutate(verb_ratio_she = replace(verb_ratio_she, verb_ratio_she < 1, 0)) %>%
mutate(verb_ratio_he = replace(verb_ratio_he, verb_ratio_he < 1, 0)) %>%
#  mutate()
arrange(desc(verb_ratio_he))
view(austen_he)
view(gender_combine)
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n)) %>%
mutate(verb_ratio_she = replace(verb_ratio_she, verb_ratio_she < 1, 0)) %>%
mutate(verb_ratio_he = replace(verb_ratio_he, verb_ratio_he > -1, 0)) %>%
#  mutate()
arrange(desc(verb_ratio_he))
view(gender_combine)
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n)) %>%
mutate(verb_ratio_she = replace(verb_ratio_she, verb_ratio_she < 1, 0)) %>%
mutate(verb_ratio_he = replace(verb_ratio_he, verb_ratio_he > -1, 0)) %>%
mutate(verb_ratio = verb_ratio_she + verb_ratio_he) %>%
arrange(desc(verb_ratio_he))
view(gender_combine)
tidy_gender <- gender_combine %>%
filter(head(gender_combine, 15) | tail(gender_combine,15)) %>%
ggplot(aes(fct_reorder(word, verb_ratio), verb_ratio)) +
geom_col(show.legend =FALSE) +
coord_flip()
gender_perception <- rbind(head(gender_combine, 15), tail(gender_combine, 15))
view(gender_perception)
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n)) %>%
mutate(verb_ratio_she = replace(verb_ratio_she, verb_ratio_she < 1, 0)) %>%
mutate(verb_ratio_he = replace(verb_ratio_he, verb_ratio_he > -1, 0)) %>%
mutate(verb_ratio = verb_ratio_she + verb_ratio_he) %>%
arrange(desc(verb_ratio))
view(gender_combine)
gender_perception <- rbind(head(gender_combine, 15), tail(gender_combine, 15))
view(gender_perception)
gender_perception %>%
ggplot(aes(fct_reorder(word, verb_ratio), verb_ratio)) +
geom_col(show.legend =FALSE) +
coord_flip()
austen_bigrams %>%
count(bigram, sort = TRUE)
austen_bigrams
austen_separated <- austen_bigrams %>%
separate(bigram, c("word1", "word2"), sep = " ")
austen_separated
austen_she <- austen_separated %>%
filter(word1 == "she") %>%
count(book, word2)
austen_she
austen_she <- austen_separated %>%
filter(word1 == "she") %>%
count(book, word2) %>%
rename(word = word2, she_n = n)
austen_she
austen_she <- austen_separated %>%
filter(word1 == "she") %>%
count(book, word2) %>%
rename(word = word2, she_n = n) %>%
select(-book)
austen_she
austen_she <- austen_separated %>%
filter(word1 == "she") %>%
count(book, word2) %>%
rename(word = word2, she_n = n) %>%
select(-book) %>%
group_by(word) %>%
summarize(she_n = sum(she_n))
austen_she
view(austen_she)
austen_she <- austen_separated %>%
filter(word1 == "she") %>%
count(book, word2)
austen_she
view(austen_she)
austen_she <- austen_separated %>%
filter(word1 == "she") %>%
count(book, word2) %>%
rename(word = word2, she_n = n) %>%
select(-book) %>%
group_by(word) %>%
summarize(she_n = sum(she_n)) %>%
filter(she_n > 1) %>%
arrange(desc(she_n))
view(austen_she)
austen_he <- austen_separated %>%
filter(word1 == "he") %>%
count(book, word2) %>%
rename(word = word2, he_n = n) %>%
select(-book) %>%
group_by(word) %>%
summarize(he_n = sum(he_n)) %>%
filter(he_n > 1) %>%
arrange(desc(he_n))
view(austen_he)
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio = log2(she_n / he_n)) %>%
arrange(desc(verb_ratio))
view(gender_combine)
gender_perception <- rbind(head(gender_combine, 15), tail(gender_combine, 15))
view(gender_perception)
gender_perception %>%
ggplot(aes(fct_reorder(word, verb_ratio), verb_ratio)) +
geom_col(show.legend =FALSE) +
coord_flip()
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio = log(she_n / he_n)) %>%
arrange(desc(verb_ratio))
view(gender_combine)
gender_perception <- rbind(head(gender_combine, 15), tail(gender_combine, 15))
gender_perception %>%
ggplot(aes(fct_reorder(word, verb_ratio), verb_ratio)) +
geom_col(show.legend =FALSE) +
coord_flip()
gender_combine <- inner_join(austen_she, austen_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio = log2(she_n / he_n)) %>%
arrange(desc(verb_ratio))
gender_perception <- rbind(head(gender_combine, 15), tail(gender_combine, 15))
gender_perception %>%
ggplot(aes(fct_reorder(word, verb_ratio), verb_ratio)) +
geom_col(show.legend =FALSE) +
coord_flip()
tidy_dickens
charles_dickens_collection
charles_dickens_collection %>% count(title)
dickens_bigrams <- charles_dickens_collection %>%
group_by(title) %>%
mutate(linenumber = row_number(),
chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]", ignore_case = TRUE)))) %>%
ungroup() %>%
unnest_tokens(bigram, text, token = "ngrams", n = 2)
dickens_bigrams
dickens_bigrams %>%
count(bigram, sort = TRUE)
dickens_separated <- dickens_bigrams %>%
separate(bigram, c("word1", "word2"), sep = " ")
dickens_separated
dickens_bigrams %>%
count(bigram, sort = TRUE) %>%
select(-gutenberg_id)
dickens_bigrams
dickens_bigrams <- charles_dickens_collection %>%
group_by(title) %>%
mutate(linenumber = row_number(),
chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]", ignore_case = TRUE)))) %>%
ungroup() %>%
unnest_tokens(bigram, text, token = "ngrams", n = 2) %>%
select(-gutenberg_id)
dickens_bigrams
dickens_bigrams <- charles_dickens_collection %>%
group_by(title) %>%
mutate(linenumber = row_number(),
chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]", ignore_case = TRUE)))) %>%
ungroup() %>%
unnest_tokens(bigram, text, token = "ngrams", n = 2) %>%
select(-gutenberg_id, linenumber, chapter)
dickens_bigrams
charles_dickens_collection <- gutenberg_download(c(1400, 98, 1023, 24022, 766, 730),
meta_fields = "book")
charles_dickens_collection %>% count(title)
# Tidy the corpus
dickens_bigrams <- charles_dickens_collection %>%
group_by(book) %>%
mutate(linenumber = row_number(),
chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]", ignore_case = TRUE)))) %>%
ungroup() %>%
unnest_tokens(bigram, text, token = "ngrams", n = 2) %>%
select(-gutenberg_id, linenumber, chapter)
charles_dickens_collection <- gutenberg_download(c(1400, 98, 1023, 24022, 766, 730),
meta_fields = "title")
charles_dickens_collection %>% count(title)
# Tidy the corpus
dickens_bigrams <- charles_dickens_collection %>%
group_by(title) %>%
mutate(linenumber = row_number(),
chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]", ignore_case = TRUE)))) %>%
ungroup() %>%
unnest_tokens(bigram, text, token = "ngrams", n = 2) %>%
select(-gutenberg_id, linenumber, chapter)%>%
rename(book = title)
dickens_bigrams
dickens_bigrams <- charles_dickens_collection %>%
group_by(title) %>%
mutate(linenumber = row_number(),
chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]", ignore_case = TRUE)))) %>%
ungroup() %>%
unnest_tokens(bigram, text, token = "ngrams", n = 2) %>%
select(-gutenberg_id, -linenumber, -chapter)%>%
rename(book = title)
dickens_bigrams
dickens_bigrams %>%
count(bigram, sort = TRUE)
dickens_separated <- dickens_bigrams %>%
separate(bigram, c("word1", "word2"), sep = " ")
dickens_separated
dickens_she <- dickens_separated %>%
filter(word1 == "she") %>%
count(book, word2) %>%
rename(word = word2, she_n = n) %>%
select(-book) %>%
group_by(word) %>%
summarize(she_n = sum(she_n)) %>%
filter(she_n > 1) %>%
arrange(desc(she_n))
view(dickens_she)
dickens_he <- dickens_separated %>%
filter(word1 == "he") %>%
count(book, word2) %>%
rename(word = word2, he_n = n) %>%
select(-book) %>%
group_by(word) %>%
summarize(he_n = sum(he_n)) %>%
filter(he_n > 1) %>%
arrange(desc(he_n))
view(dickens_he)
gender_combine <- inner_join(dickens_she, dickens_he) %>%
anti_join(stop_words)  %>%
mutate(verb_ratio_she = she_n / he_n, verb_ratio_he = -1*(he_n / she_n)) %>%
mutate(verb_ratio_she = replace(verb_ratio_she, verb_ratio_she < 1, 0)) %>%
mutate(verb_ratio_he = replace(verb_ratio_he, verb_ratio_he > -1, 0)) %>%
mutate(verb_ratio = verb_ratio_she + verb_ratio_he) %>%
arrange(desc(verb_ratio))
view(gender_combine)
gender_perception <- rbind(head(gender_combine, 15), tail(gender_combine, 15))
view(gender_perception)
gender_perception %>%
ggplot(aes(fct_reorder(word, verb_ratio), verb_ratio)) +
geom_col(show.legend =FALSE) +
coord_flip()
gender_perception <- rbind(head(gender_combine, 15), tail(gender_combine, 15))
view(gender_perception)
gender_perception %>%
ggplot(aes(fct_reorder(word, verb_ratio), verb_ratio)) +
geom_col(show.legend =FALSE) +
coord_flip()
